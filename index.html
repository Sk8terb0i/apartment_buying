<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Apartment Shopping Tracker</title>
<style>
  table { border-collapse: collapse; width: 50%; margin: 20px; }
  th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
  .highlight { background-color: #a0ffa0; }
</style>
</head>
<body>
<h1>Shopping Tracker</h1>
<table id="itemsTable">
  <thead>
    <tr>
      <th>Item</th>
      <th>Next Buyer</th>
      <th>Bought?</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
const sheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vT5msEYqaYPEQUzUHbuMUqIdCS-eqVGgP12yz0oPEHxPoyG4T1NBZN_Rt8SvDMTJMjnnEiR-_Mz3EH7/pub?output=csv';

async function loadData() {
  const response = await fetch(sheetUrl);
  const csvText = await response.text();
  const rows = csvText.trim().split('\n').map(r => r.split(','));
  const tbody = document.querySelector('#itemsTable tbody');
  tbody.innerHTML = '';

  for (let i = 1; i < rows.length; i++) {
    const [item, peopleStr, turnIndexStr] = rows[i];
    const people = peopleStr.split(';');
    const turnIndex = parseInt(turnIndexStr);
    const nextBuyer = people[turnIndex];

    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${item}</td>
      <td class="highlight">${nextBuyer}</td>
      <td><input type="checkbox" data-item="${item}"></td>
    `;
    tbody.appendChild(tr);
  }
}

loadData();
</script>
</body>
</html>
